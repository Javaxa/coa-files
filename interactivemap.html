<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Map Program</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="settings-button">
        <button class="btn btn-primary btn-style" data-bs-toggle="modal" data-bs-target="#settingsModal"><i class="fa-solid fa-gear"></i></button>
    </div>

<!--Incursion Legend-->

    <div class="legend-wrapper">
        <h5>Map Legend</h5>
        <div class="legend-item">
            <div class="point-dot custom-div-icon" style="background: #fff; border: 1px solid #000; margin-left: 2px;">DH</div>
            <span class="legend-text">20ft Incursion</span>
        </div>
        <div class="legend-item">
            <div class="point-dot red-dot-icon" style="margin-left: 2px;"></div>
            <span class="legend-text">4ft Incursion</span>
        </div>
        <div class="legend-item">
            <img src="overlays/shafticon.png" alt="Shaft" style="width: 26px; height: 26px; margin-right: 8px">
            <span class="legend-text">Shaft</span>
        </div>
        <div class="legend-item">
            <div class="point-dot source-icon icon-width"></div>
            <span class="legend-text">Source Sample</span>
        </div>
        <div class="legend-item">
            <div class="point-dot purple-rectangle-icon icon-width"></div>
            <span class="legend-text">Rock</span>
        </div>
    </div>







        

        <div class="container-fluid mt-5">
            <button id="elementPricesBtn" class="btn btn-primary mb-3">View Element Prices</button>
            <h1 class="mb-4 map-title">Interactive Map</h1>
            <h5 class="main-title">Cuddeback Lake Basin</h5>
    
            <div class="dashboard-container">
                <div class="dashboard-column" id="averages-column">
                    <div id="elementAverageBox">
                        <div style="display: flex; justify-content: space-between;">
                            <h4>Elemental Data:</h4>
                        </div>
                        <div id="selectedElementContainer">
                            <span id="selectedElementName"></span>
                            <span id="selectedElement" data-bs-toggle="modal" data-bs-target="#periodicModal" data-tooltip="Expand Element Selection Menu"></span>
                        </div>
                        <div id="overallAverages" class="zone-item">
                            <div class="zone-title basin-title">Basin Statistics:</div>
                            <div class="zone-stat empty-space">
                                <span>Assays Done:</span>
                                <span id="overallAssayCount" style="font-weight: bold;"></span>
                            </div>
                            <div class="zone-stat">
                                <span>Average:</span>
                                <span id="averageValue" class="average-value"></span>
                            </div>
                            <div class="zone-stat">
                                <span>Value/tonne:</span>
                                <span id="averageValuePerTonne" class="price-value"></span>
                            </div>
                            <div class="zone-stat empty-space-top">
                                <span>Highest:</span>
                                <span id="highestValue" class="highest-value"></span>
                            </div>
                            <div class="zone-stat">
                                <span>Value/tonne:</span>
                                <span id="highestValuePerTonne" class="price-value"></span>
                            </div>
                        </div>
                        <div id="zoneAveragesBox" class="mt-2">
                            <div class="zone-stat-title">Zone Statistics:</div>
                            <div id="zoneAveragesList"></div>
                            <button id="visualizeButton" class="btn btn-sm btn-outline-primary" style="width: 100%;">Visualize as Charts</button>
                        </div>
                    </div>
                </div>
                <div class="dashboard-column" id="map-column">
                    <div id="map"></div>
                </div>
                <div class="dashboard-column" id="filters-column">
                    <div id="sidebar">
                            <h5>Filters</h3>
                            <button class="btn btn-secondary d-flex justify-content-between align-items-center" type="button" data-bs-toggle="collapse" data-bs-target="#incursionFilters" aria-expanded="false" aria-controls="incursionFilters">
                                Incursion Type <span class="filter-arrow">&darr;</span>
                            </button>
                            <div class="collapse" id="incursionFilters">
                                <div class="checkbox-container">
                                    <label><input type="checkbox" value="HY20" checked> 20-Foot</label>
                                    <label><input type="checkbox" value="HN04"> 4-Foot</label>
                                    <label><input type="checkbox" value="Shaft"> Shaft</label>
                                    <label><input type="checkbox" value="Source Sample"> Source Sample</label>
                                    <label><input type="checkbox" value="Rock"> Rock</label>
                                </div>
                            </div>
                            <button class="btn btn-secondary d-flex justify-content-between align-items-center" type="button" data-bs-toggle="collapse" data-bs-target="#assayFilters" aria-expanded="false" aria-controls="assayFilters">
                                Assay Type <span class="filter-arrow">&darr;</span>
                            </button>
                            <div class="collapse" id="assayFilters">
                                <div class="checkbox-container">
                                    <label><input type="checkbox" value="4-Acid Dig"> 4-Acid</label>
                                    <label><input type="checkbox" value="LMB Flux" checked> LMB Flux</label>
                                    <label><input type="checkbox" value="LMB+" checked> LMB+</label>
                                    <label><input type="checkbox" value="LMB+ (Metallurgical)"> LMB+ (Metallurgical)</label>
                                </div>
                            </div>
                            <button class="btn btn-secondary d-flex justify-content-between align-items-center" type="button" data-bs-toggle="collapse" data-bs-target="#zoneFilters" aria-expanded="false" aria-controls="zoneFilters">
                                Zone <span class="filter-arrow">&darr;</span>
                            </button>
                            <div class="collapse" id="zoneFilters">
                                <div class="checkbox-container">
                                    <label><input type="checkbox" value="1" checked> Zone 1</label>
                                    <label><input type="checkbox" value="2" checked> Zone 2</label>
                                    <label><input type="checkbox" value="3" checked> Zone 3</label>
                                    <label><input type="checkbox" value="4" checked> Zone 4</label>
                                    <label><input type="checkbox" value="5" checked> Zone 5</label>
                                    <label><input type="checkbox" value="6" checked> Zone 6</label>
                                </div>
                            </div>
                            <button class="btn btn-secondary d-flex justify-content-between align-items-center" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarCOAFilters" aria-expanded="false" aria-controls="sidebarCOAFilters">
                                COA <span class="filter-arrow">&darr;</span>
                            </button>
                            <div class="collapse mt-2" id="sidebarCOAFilters">
                                <div class="checkbox-container" id="sidebarCOACheckboxContainer">
                        
                                </div>
                            </div>
                        <button class="btn btn-secondary d-flex justify-content-between align-items-center" type="button" data-bs-toggle="collapse" data-bs-target="#cutoffGradeFilter" aria-expanded="false" aria-controls="cutoffGradeFilter">
                            Cut-off Grade <span class="filter-arrow">&darr;</span>
                        </button>
                        <div class="collapse mt-2" id="cutoffGradeFilter">
                                <div class="checkbox-container">
                                    <div class="form-group">
                                        Minimum ppm:
                                        <input type="number" style="display: inline;" class="form-control" id="minCutoff">
                                    </div>
                                    <div class="form-group">
                                        Maximum ppm:
                                        <input type="number" style="display: inline;" class="form-control" id="maxCutoff">
                                    </div>
                                    <button class="btn btn-primary mt-2" id="applyCutoff">Apply</button>
                                    <button class="btn btn-danger mt-2" style="margin-top: -5px !important;" id="removeCutoff">Remove</button>
                            </div>
                        </div>
                        
                            <button class="btn btn-secondary d-flex justify-content-between align-items-center" type="button" data-bs-toggle="collapse" data-bs-target="#overlayFilters" aria-expanded="false" aria-controls="overlayFilters">
                                Overlays <span class="filter-arrow">&darr;</span>
                            </button>
                            <div class="collapse" id="overlayFilters">
                                <div class="overlay-checkbox-container">
                                    <label><input type="checkbox" value="Zone" checked> Zone</label>
                                    <label><input type="checkbox" value="Claims"> Claims</label>
                                    <label><input type="checkbox" value="Sections"> Sections</label>
                                <div class="heatmap-controls">
                                    <h6>Heatmap Controls</h6>
                                    <button id="toggleHeatmapButton" class="btn btn-sm btn-outline-primary">Show Heatmap</button>
                                    <button id="heatmapModeButton" class="btn btn-sm btn-outline-danger">Heatmap by Highest ppm</button>
                                </div>
                            </div>
                        </div>
                    </div>
        </div>
  

   











<!--Modals-->
<div class="modal fade" id="visualizationModal" tabindex="-1" aria-labelledby="visualizationModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" style="max-width: 1100px;">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="visualizationModalLabel">Zone Statistics Visualization</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="chart-container">
                    <div class="chart-wrapper">
                        <canvas id="barChart"></canvas>
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="pieChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
        <div class="modal fade" id="coaModal" tabindex="-1" aria-labelledby="coaModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg" style="max-width: 1150px;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="coaModalLabel"></h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <iframe id="coaIframe" src="" width="100%" height="600px" style="display: none;"></iframe>
                        <div id="excelContainer" style="display: none;"></div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>          
        <div class="modal fade" id="periodicModal" tabindex="-1" aria-labelledby="periodicModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg" style="max-width: 1100px;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="periodicModalLabel">Select Element of Interest</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">

                    </div>
                    <div class="modal-footer">
                        <select id="elementSelect" class="form-select select-style mb-3">
                            <option value="Au">Gold (Au)</option>
                            <option value="Pt">Platinum (Pt)</option>
                            <option value="Pd">Palladium (Pd)</option>
                            <option value="Rh">Rhodium (Rh)</option>
                            <option value="Ir">Iridium (Ir)</option>
                            <option value="Os">Osmium (Os)</option>
                            <option value="Ru">Ruthenium (Ru)</option>
                            <option value="Ag">Silver (Ag)</option>
                            <option value="Al">Aluminum (Al)</option>
                            <option value="As">Arsenic (As)</option>
                            <option value="B">Boron (B)</option>
                            <option value="Ba">Barium (Ba)</option>
                            <option value="Be">Beryllium (Be)</option>
                            <option value="Bi">Bismuth (Bi)</option>
                            <option value="Ca">Calcium (Ca)</option>
                            <option value="Cd">Cadmium (Cd)</option>
                            <option value="Ce">Cerium (Ce)</option>
                            <option value="Co">Cobalt (Co)</option>
                            <option value="Cr">Chromium (Cr)</option>
                            <option value="Cs">Cesium (Cs)</option>
                            <option value="Cu">Copper (Cu)</option>
                            <option value="Cl">Chlorine (Cl)</option>
                            <option value="Fe">Iron (Fe)</option>
                            <option value="Ga">Gallium (Ga)</option>
                            <option value="Ge">Germanium (Ge)</option>
                            <option value="Hf">Hafnium (Hf)</option>
                            <option value="Hg">Mercury (Hg)</option>
                            <option value="In">Indium (In)</option>
                            <option value="K">Potassium (K)</option>
                            <option value="La">Lanthanum (La)</option>
                            <option value="Li">Lithium (Li)</option>
                            <option value="Mg">Magnesium (Mg)</option>
                            <option value="Mn">Manganese (Mn)</option>
                            <option value="Mo">Molybdenum (Mo)</option>
                            <option value="Na">Sodium (Na)</option>
                            <option value="Nb">Niobium (Nb)</option>
                            <option value="Ni">Nickel (Ni)</option>
                            <option value="P">Phosphorus (P)</option>
                            <option value="Pb">Lead (Pb)</option>
                            <option value="Rb">Rubidium (Rb)</option>
                            <option value="Re">Rhenium (Re)</option>
                            <option value="S">Sulfur (S)</option>
                            <option value="Sb">Antimony (Sb)</option>
                            <option value="Sc">Scandium (Sc)</option>
                            <option value="Se">Selenium (Se)</option>
                            <option value="Sn">Tin (Sn)</option>
                            <option value="Sr">Strontium (Sr)</option>
                            <option value="Ta">Tantalum (Ta)</option>
                            <option value="Te">Tellurium (Te)</option>
                            <option value="Th">Thorium (Th)</option>
                            <option value="Ti">Titanium (Ti)</option>
                            <option value="Tl">Thallium (Tl)</option>
                            <option value="U">Uranium (U)</option>
                            <option value="V">Vanadium (V)</option>
                            <option value="W">Tungsten (W)</option>
                            <option value="Y">Yttrium (Y)</option>
                            <option value="Zn">Zinc (Zn)</option>
                            <option value="Zr">Zirconium (Zr)</option>
                            <option value="Dy">Dysprosium (Dy)</option>
                            <option value="Er">Erbium (Er)</option>
                            <option value="Eu">Europium (Eu)</option>
                            <option value="Gd">Gadolinium (Gd)</option>
                            <option value="Ho">Holmium (Ho)</option>
                            <option value="Lu">Lutetium (Lu)</option>
                            <option value="Nd">Neodymium (Nd)</option>
                            <option value="Pr">Praseodymium (Pr)</option>
                            <option value="Sm">Samarium (Sm)</option>
                            <option value="Tb">Terbium (Tb)</option>
                            <option value="Tm">Thulium (Tm)</option>
                            <option value="Yb">Ytterbium (Yb)</option>                               
                        </select>   
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="elementPricesModal" tabindex="-1" aria-labelledby="elementPricesModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="elementPricesModalLabel">Element Prices (per gram)</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div id="elementPricesContainer" class="row"></div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="settingsModal" tabindex="-1" aria-labelledby="settingsModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="settingsModalLabel">Settings</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="darkModeToggle">
                            <label class="form-check-label" for="darkModeToggle">
                                Dark Mode
                            </label>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>    
    </div>



    <!--Table Element selection and heatmap Legend-->
        <div id="heatmapLegend" class="legend-wrapper" style="display: none;">
            <h5>Heatmap Legend</h5>
            <div id="legendColors"></div>
        </div>
        <div class="mt-4" style="max-width: 1200px; margin: auto;">
            <button class="table-download btn btn-outline-primary mb-3">Export Data to Excel</button>
            <button id="clearSelectionButton" class="btn btn-outline-danger mb-3" style="display:none;" onclick="clearPointSelection()">Remove Drill Hole Selection</button>
            <span id="selectedDH" class="ml-2"></span>    
            <span id="selectedElementPPM" class="ml-2"></span>
            <span id="selectedElementHighestPPM" class="ml-2"></span>             
            <table id="elementTable" class="table table-striped table-bordered">
                <thead>
                    <tr>
                        <th data-column="Description" class="sortable">Description</th>
                        <th data-column="Incursion Type" class="sortable">Incursion Type</th>
                        <th data-column="Lab" class="sortable">Lab</th>
                        <th data-column="STID" class="sortable">STID</th>
                        <th data-column="Zone" class="sortable">Zone</th>
                        <th data-column="Northing" class="sortable">Northing</th>
                        <th data-column="Easting" class="sortable">Easting</th>
                        <th data-column="DH" class="sortable">DH</th>
                        <th data-column="Depth" class="sortable">Depth (ft)</th>
                        <th data-column="Assay Type" class="sortable">Assay Type</th>
                        <th data-column="COA" class="sortable">COA</th>
                        <th data-column="Sample Weight" class="sortable">Sample Weight (kg)</th>
                        <th data-column="Element (PPM)" class="sortable">Element (ppm)</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.7.5/proj4.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.heat/0.2.0/leaflet-heat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="js/main.js"></script>
</body>
</html>

